# 4장_역할, 책임, 협력

이번 장이 객체 지향의 꽃이지 않을까..

---

Q. 좋은 객체 지향이란 무엇일까?

A. 각 객체마다 역할을 잘 부여해줄 수 있는 것. 객체가 서로 소통할 수 있는 수단은 메세지 밖에 없다.

---

Q. 음.. 알겠어 그니까 좋은 설계를 할려면 어떻게 해야되는데?  
A. 우선 처음으로는 객체의 역할을 정한다. 처음부터 메세지를 고려할 필요는 없다.

---

Q. ???? 아니 역할이 먼저임? 확실함?

A. ㅇㅇ 객체의 역할은 하나의 메세지로 해결되는 것이 아님
객체의 역할을 다하기 위해 여러가지 메세지를 주고 받으며 역할을 완수하게 됨
물론 메세지(즉, 메서드)를 먼저 고려할 수 있겠지만 큰 그림을 먼저 잡고 안을 구현하는게 훨씬 편하잖아
그니까 역할을 우선적으로 생각해보고 이 역할을 위해 어떤 객체에게 메세지를 보내야할까 고민해봐

---

### 협력의 추상화

역할의 가장 큰 가치는 하나의 협력 안에 여러 종류의 객체가 참여할 수 있는 것이다.

즉, 엘리스 이야기를 할 때

킹 - 토끼 - 모자 장수 의 구체화 되어있는 객체를 추상화 하여

판사 - 토끼 - 증인 으로 추상화 할 수 있는 것이다.

역할은 변할 수도 있다.

ex) 모자 장수는 여기서는 증인의 역할을 하지만 평생 모자를 파는 역할을 해왔다.

> 하.. 다른 역할을 할 수 있다고..? 이게 좋은 설계인가..? 흠..
> 

### 객체는 정적인 클래스가 아니라 협력에 참여하는 동적인 객체이다.

이 말은 듣는 사람에 따라 다르게 들릴 것 같다.

~~그래서 너네는 어떻게 들리니?~~

**나는 이 문장은 모든 것을 객체로 생각해 보라는 메세지인 것 같다.**

예를 들어 상태 패턴이 생각난다.

처음 상태 패턴을 봤을 때 충격적이었다.

이런걸 객체로 볼 수 있구나, 이렇게 하면 엄청 깔끔한 설계가 나올 수 있구나를 느꼈다.

[[10분 테코톡] 🍒 포모의 상태 패턴](https://www.youtube.com/watch?v=wYMN3sPIeHY)

### 객체 지향 설계 기법

1. RDD
    
    객체의 책임을 중심으로 설계하는 방법
    
2. 디자인 패턴
    
    책임 - 주도 설계의 결과
    
3. TDD
    
    객체가 있다고 가정하고 실패하는 테스트를 만든 다음 테스트를 성공하기 위한 최적의 코드를 짜는 것
    

이렇게 3가지 기법이 있다고 한다.

`이것 중 뭐가 제일 좋을까?` 라는 질문은 어리석다고 생각한다.(~~TDD 최고..~~)

이 세가지를 잘 섞어 사용하는 것이 좋은 설계를 만들 수 있다고 생각한다.

Q. 그럼 넌 설계 어떻게 함?

A. 나는 우선 RDD 처럼 접근 하는 것 같다. 객체의 책임을 부여하고 전체적인 도메인 지식을 학습한다.
어느 정도의 그림을 그려놓고 TDD로 접근한다. TDD로 구현하며 놓쳤던 작은 부분들을 잡아나간다.
이렇게 프로덕트를 완성 후 쳐다보면 불편한 곳이 보인다. (안이쁘다거나..)

이 때 디자인 패턴을 도입해 보다 더 깔끔한 코드를 만들려고 한다.

# 5장_책임과 메세지

### 자율적인 책임

메세지를 전달할 때 너무 구체적이면 수신자의 자율성이 떨어진다.

하지만 너무 추상적이여도 안된다.

> 메세지를 전달할 때 너무 구체적이면 수신자의 자율성이 떨어진다.
> 

왜일까? 난 캡슐화의 문제로 이어진다고 생각한다.

책에서 예시를 든 재판 과정을 살펴보자

왕이 모자장수에게 증언하라! 가 아니고

1. 목격했던 장면을 떠올려라
2. 떠오르는 기억을 시간 순으로 재구성하라
3. 말로 간결하게 표현하라

이 말은 왕이 증언 과정을 다 알고 하나씩 호출하고 있는 것이다.

왕이 증언 과정을 알고 있어야 할까?

왕은 그냥 증인 역할을 한 사람한테 “님 말하셈 ㄱㄱ” 만 하면 되지 않을까?

왕이 증인이 말할 과정을 알고 있다 → 캡슐화가 깨진다. 라고 생각한다.

### 다형성

다형성의 시작은 송신자와 수신자의 결합도를 낮추면서 시작된다.

결합도를 낮춘다는 것이 뭘까?

종속적인 설계를 막는 것이다.

내가 어떠한 설계를 할 때 얘 말고 다른 애가 들어와도 할 수 있나?

라는 개념을 가지고 설계를 하면 좋을 것 같다.

### What/Who 사이클

어떤 행위를 먼저 할 지 고민 후 누가 할지 정해라

즉, 메세지를 먼저 생각한 후 수신자를 정해라

### 인터페이스

인터페이스를 써야하는 이유, 인터페이스와 구현의 분리 등등을 설명한다.

책에서는 인터페이스를 써야한다고 말한다.

이 인터페이스는 우리가 알고 있는 자바의 인터페이스 보다 조금 더 추상적인 개념이라 생각하면 좋을 것 같다.

인터페이스는 결합도를 낮추고 확장성을 열어둘 수 있다.

이 말은 즉, 캡슐화를 보장해줄 수 있다는 뜻이다.

사실 모든 곳을 인터페이스로 추상화 하여 사용하면 좋을 것이다.

OCP원칙을 살펴보더라도 `변경에는 닫혀있고 확장에는 열려있다.` 이 문장을 고려해 봤을 때 모든 곳에 인터페이스를 사용하는 것도 방법이 될 수 있다.

하지만 이 또한 남발하게 되면 리소스 낭비이고 오버 엔지니어링이 될 수 있다.

우리는 적당한 수준의 추상화 단계를 생각하여 설계를 하자!
