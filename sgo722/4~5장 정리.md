4~5

# 역할, 책임, 협력

객체지향 설계의 전체적인 품질을 결정하는 것은 개별 객체의 품질이 아니라 여러 객체들이 모여 이뤄내는 협력의 품질이다. 


### 협력

협력은 한 사람이 다른 사람에게 도움을 요청할 떄 시작된다.

pg.112에 파이를 훔친 하트 잭에 대한 공판이 열리고 있는 법정의 모습을 묘사한 후, 이 법정에 모인 이유에 대해서 묻는 장면이 있는데 이 과정에서 나는 애플리케이션의 목적을 묻는다고 느꼈다. 즉 협력을 하기 위해서는 우리가 어떤 프로그램을 만들기 위해서는 이 프로그램이 제공하고자하는 목적이 무엇인지 알아야하기 때문에 협력이전에, 어떤 목적이 있어야한다는 것을 말해주는 것 같았다.


### 책임
어떤 객체가 어떤 요청에 대해서 대답해 줄 수 있거나 적절한 행동을 할 수 있으면 해당 객체가 책임을 가진다고 말한다.

객체의 책임은 ‘객체가 무엇을 알고 있는가?’와 ‘객체가 무엇을 할 수 있는가’로 구성된다.

적절한 객체에게 적절한 책임을 주는것이 중요하다.


객체지향을 설계할 때는 메시지를 통해서 객체들간의 협력이 이뤄지고, 메시지를 보내는 객체를 송신자, 메시지를 요청받아 처리하는 객체를 수신자라고 한다.

pg. 118
Q1)
책임과 메시지의 수준이같지 않다고 한다. 책임을 결정한 후 실제로 협력을 정제하면서 이를 메시지로 변환할 때는 하나의 책임이 여러 메시지로 분할되는 것이 일반적이다라고 적혀있는데 코드를 짜본 경험이 많지 않다보니 이 말의 의미가 크게 와닿지 않았다. 그래서 너희들은 이말을 어떻게 해석했는지 알고싶다.

### 역할
역할은 책임들의 집합으로, 협력 내에서 동일한 책임을 수행할 수 있다면 같은 역할을 하는 것이다.

역할을 사용하면 유사한 협력을 추상화할 수 있다. 책의 예시로는 판사-토끼-증인의 세가지 역할을 나누기 이전에는 판사에 해당하는 객체를 따로두고, 증인에 해당하는 객체를 따로두다가 마지막에는 결국 똑같은 협력안에서 같은 책임을 수행할 수 있다면 같은 역할을 하고 있기때문에 하나의 객체로 두지않고 역할로써 대체한다면 협력에 대해서 파악하기 쉬워지고, 객체지향적인 개념에서 본다면 협력이 유연해진다는 것을 알 수 있다.

협력을 고려하고 책임중심으로 설계를 하고 그안에 필요한 데이터를 생각해야한다고 했는데, 우리가 봤던 재판과정에서 왕과 하얀토끼, 모자장수라는 객체들이 가지고 있는 행동은 알곘다. 그런데 이들이 가져야하는 필드는 무엇이 있을지에 대해서 같이 고민해보고 싶다.

그리고 필요한 데이터라는 것으로 하얀토끼가 모자장수라는 필드값도 필요할텐데 이것도 데이터로써 봐야하는건지 궁금하다.(== 조합으로 가지고 있는 객체도 데이터로 보는건가요?)


### 디자인패턴
디자인 패턴을 사용하면 책임-주도 설계의 절차를 수나적으로 따르지 않고도 빠르게 협력,책임,역할을 파악할 수 있다.

composite 패턴
Composite 패턴은 전체와 부분을 하나의 단위로 추상화해야하는 경우에 사용할 수 있는 패턴이다.
—> 시간이 된다면 찾아보고 말해보자..

## 테스트주도개발
테스트-주도 개발은 객체가 이미 존재한다고 가정하고 객체에게 어떤 메세지를 전송할 것인지에 관해 먼저 생각하라고 충고한다.

테스트주도개발을 직접해본적이 없지만,  저번에 호연이가 미션을 진행하면서 테스트코드를 300개를 작성했었다는 것이 기억이 났다. 그리고 나에게 테스트코드를 어떻게 썻는지 보여줬었고, 그런 과정에서 테스트를 싹 갈아엎었어야하는 일도 있었다했다. 또, 테스트코드를 작성하는 귀찮음과 내 인생을 나락으로 보내는 선택지로서 전자를 선택하는게 트레이드오프관점에서 맞는 것 같다는 얘기도 해주었다. 이 부분은 호연이한테 그런 점에 대해서 얘기해달라고 메시지를 전송해야겠다.
hogi.sayTest();


# 05 책임과 메시지
초반에 책임에 관한 실험얘기로 시작한다. 결국에 이 얘기로 전하고싶은 메시지는 객체지향세계에서는 협력에 참여하는 객체들에게는 명확한 책임과 역할을 부여해야한다는 것이다.

###  자신의 의지에 따라 증언할 수 있는 자유
판사가 증인에게 증언하라정도의 메시지를 보내면 증인은 자율적으로 증언할 수 있지만, 판사가 증언하는 방법에 대해 명령을 내리면 증인은 증언할 수 있는 방법이 하나로 고정되버린다. 객체지향에서 이렇게 사용하면 객체의 자율성을 낮춰 객체지향 품질이 낮아지게 된다.
 ### 너무 추상적인 책임
여기서 말하고자하는 것은 메시지를 보낼때의 메시지의 이름을 잘 지으라고 말하는 것 같다.

재판이라는 문맥에서 “증언하라”라는 메시지를 받았을땐 증인으로서 알고 있는 것을 말하라라는 의미로 해석할 수 있겠지만, “설명하라”라고 메세지가 넘어온다면 내 역할에 대해서 파악하기도 어렵고, 어떤 걸 설명해야하는지도 모르기때문에 문맥에 맞는 메시지명을 고려하라는 의미로 이해했다.

그리고 객체가 ‘어떻게’해야 하는가가 아니라 ‘무엇을’해야하는 가를 설명하도록 해야 자율적인 객체를 만들 수 있다.


## 메시지와 메서드
### 메시지
하나의 객체는 메세지를 전송함으로써 다른 객체에 접근한다. 

### 메서드
수신한 메시지를 처리하는 방법
객체지향 프로그래밍의 핵심적인 특징으로 이 메서드를 프로그램 실행시간에 메서드를 선택할 수 있다. => 다형성

### 다형성
서로 다른 유형의 객체가 동일한 메시지에 대해 서로 다르게 반응하는 것을 의미한다.

다형성에서 중요한 것은 송신자 관점인데, 송신자 입장에서 다형적인 수신자들을 구분할 필요가 없다. 수신자들 모두 메시지 요청을 처리할 수 있기 떄문이다.

다형성을 사용하면 설계를 유연하고 재사용 가능하게 만들 수 있다.

메시지에 대한 내용은 객체가 전달할 메시지를 정하고 적절한 객체를 찾는 선택하라는 내용으로 정리가 될 것 같다. (What - Who 사이클 어떤 행위를 할 것인지 누가 그 행위를 수행할 것인지를 결정해야한 다.)

### 묻지말고 시켜라
디미터의 법칙에 따라서 묻지말고 시켜라라는 방식을 적용하기 위해서는 위에서 언급한 메시지를 정한 다음에 누가 그 메시지를 수행할 것인지를 찾으면 된다. 이렇게되면 어떤 객체가 수행할지 알 수 없기때문에 묻지않게되고, 시키게 되기 때문이다.


### 인터페이스
인터페이스는 두 사물이 마주치는 경계지점에서 서로 상호작용할 수 있도록 이어주는 방법이나 장치를 의미한다. 인터페이스를 사용하면서 우리가 얻는 이점이 3가지로 말할 수 있다.
1. 인터페이스의 사용법만 알고있으면 내부동작에 대해서 몰라도 사용할 수 있다.
우리가 리모콘 작동원리는 몰라도 리모콘을 이용해서 채널을 바꿀수잇다는것을 알고있는것처럼 말이다.


2. 인터페이스를 알고 있다면 작동원리가 바껴도 상관없다

3. 인터페이스가 동일하기만 하면 다른 어떤 대상과도 상호작용할 수 있다.

## 인터페이스와 구현의 분리

- 좀 더 추상적인 인터페이스
- 최소 인터페이스
- 인터페이스와 구현간에 차이가 있다는 점을 인식

인터페이스와 구현의 분리 원칙은 변경을 관리하기 위한 것이다.

우리는 자율적인 객체를 만들어야한다.
1. 자율적인 객체는 협력을 단순하게 만든다.
- 객체는 다른 객체에게 어떻게하라고 요청하지 않고 어떤것을 하라고 명령하면된다.
2. 외부와 내부를 분리함으로써 자율적인 책임을 가질 수 있다
- 내가 어떻게 처리하든지 상관없다. 방법을 바꿔도되고 결국 요청받은 메시지를 처리만 할 수 있으면 된다. 그리고 변경하더래도 같은 역할만 처리한다면 문제없다.
3. 협력의 대상을 다양하게 선택할 수 있는 유연성을 지닌다.
4. 객체가 수행하는 책임들이 자율적일수록 객체의 역할을 이해하기 쉬워진다.

객체지향의 목적으로
설계를 유연하게하고,
확장 가능하고
재사용성을 높이는 방식으로 설계하기 위함이다.

이를 달성하기 위해 자율적인 객체를 만들어야한다.
자율적인 객체는 적절하게 추상화되어 있어서 ‘응집도’가 높고, 객체간의 ‘결합도’가 낮으며, ‘캡슐화’가 증진되고, ‘인터페이스와 구현이 명확히 분리’되어 있어서 설계의 ‘유연성과 ‘재사용성’을 높일 수있 다.
